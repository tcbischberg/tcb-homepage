---
import client from '../../.tina/__generated__/client';
import Static from '../components/Static';

export const getStaticPaths = async () => {
  const response = await client.queries.staticConnection();
  console.error(response);

  return response.data.staticConnection.edges?.map((edge) => {
    const filename = edge?.node?._sys.filename;
    return {
      params: {
        relativePath: filename === 'index.md' ? '/' : filename,
      },
    };
  });
};

const { relativePath } = Astro.params;

const response = await client.queries.static({
  relativePath: `${relativePath === '/' ? 'index' : relativePath}.md`,
});
---

<Static client:tina {...response} />
